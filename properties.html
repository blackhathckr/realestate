<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Properties | Kartikeya Realty - Find Your Perfect Property</title>
    <link rel="icon" href="logo.jpeg" type="image/x-icon">
    <meta name="description"
        content="Browse our extensive listings of residential, commercial, land, and farmhouse properties in Faridabad and surrounding areas.">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0F2C59',
                        secondary: '#D4AF37',
                        accent: '#333333',
                        light: '#F5F5F5',
                    },
                    fontFamily: {
                        poppins: ['Poppins', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 1s ease-in-out',
                        'slide-up': 'slideUp 0.8s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                    },
                }
            }
        }
    </script>
    <style>
        .property-banner {
            background: linear-gradient(135deg, #0F2C59 0%, #2563EB 100%);
            position: relative;
            overflow: hidden;
        }

        .property-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1605276374104-dee2a0ed3cd6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80') center/cover;
            opacity: 0.1;
            z-index: 0;
        }

        .property-banner>* {
            position: relative;
            z-index: 1;
        }

        .filter-box {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .property-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .nav-link::after {
            content: '';
            display: block;
            width: 0;
            height: 2px;
            background: #D4AF37;
            transition: width 0.3s;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        @media (max-width: 768px) {
            .property-banner {
                background-position: 65% center;
            }
        }
    </style>
</head>

<body class="font-poppins bg-white text-accent">
    <!-- Header/Navigation -->
    <header class="sticky top-0 z-50 bg-white shadow-md">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center">
                <a href="index.html"><img src="logo.jpeg" alt="Kartikeya Realty Logo" class="h-12 mr-2"></a>
                <div class="flex flex-col">
                    <a href="index.html"><span class="text-primary font-bold text-xl sm:block">KARTIKEYA
                            REALTY</span></a>
                    <a href="index.html"><span class="text-primary text-center font-bold text-xs sm:block">Property
                            Consultant</span></a>
                </div>
            </div>

            <nav class="hidden md:flex space-x-8">
                <a href="index.html" class="nav-link text-primary font-medium hover:text-secondary">Home</a>
                <a href="properties.html" class="nav-link text-primary font-medium hover:text-secondary">Properties</a>
                <a href="investor-zone.html" class="nav-link text-primary font-medium hover:text-secondary">Investor
                    Zone</a>
                <a href="first-time-buyers.html" class="nav-link text-primary font-medium hover:text-secondary">First
                    Time Buyers</a>
                <a href="leasing-services.html" class="nav-link text-primary font-medium hover:text-secondary">Leasing
                    Services</a>
                <a href="blog.html" class="nav-link text-primary font-medium hover:text-secondary">Blog</a>
                <a href="about.html" class="nav-link text-primary font-medium hover:text-secondary">About Us</a>
            </nav>

            <div class="flex items-center space-x-4">
                <a id="header-phone" href="tel:+917091651137"
                    class="bg-secondary text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-primary transition duration-300 hidden sm:block">
                    <i class="fas fa-phone mr-1"></i> Call Now
                </a>
                <button class="md:hidden focus:outline-none" id="mobile-menu-button">
                    <i class="fas fa-bars text-2xl text-primary"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div class="md:hidden hidden bg-white w-full py-4 px-4 shadow-lg" id="mobile-menu">
            <div class="flex flex-col space-y-4">
                <a href="index.html" class="text-primary font-medium hover:text-secondary">Home</a>
                <a href="properties.html" class="text-primary font-medium hover:text-secondary">Properties</a>
                <a href="investor-zone.html" class="text-primary font-medium hover:text-secondary">Investor Zone</a>
                <a href="first-time-buyers.html" class="text-primary font-medium hover:text-secondary">First Time
                    Buyers</a>
                <a href="leasing-services.html" class="text-primary font-medium hover:text-secondary">Leasing
                    Services</a>
                <a href="blog.html" class="text-primary font-medium hover:text-secondary">Blog</a>
                <a href="about.html" class="text-primary font-medium hover:text-secondary">About Us</a>
                <a id="header-phone-mob" href="tel:+917091651137"
                    class="bg-secondary text-white px-3 py-2 rounded-md text-center font-medium hover:bg-primary transition duration-300">
                    <i class="fas fa-phone mr-1"></i> Call Now
                </a>
            </div>
        </div>
    </header>

    <!-- Property Listing Banner -->
    <section class="property-banner text-white py-20 md:py-28 relative overflow-hidden">
        <div class="container mx-auto px-4 text-center animate-fade-in">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6 animate-slide-up">Find Your Perfect Property</h1>
            <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto animate-slide-up">Browse our extensive collection of
                residential, commercial, and land properties</p>
        </div>
    </section>

    <!-- Property Filters -->
    <section class="py-8 bg-light">
        <div class="container mx-auto px-4">
            <div class="bg-white rounded-lg p-6 filter-box">
                <h2 class="text-xl font-bold text-primary mb-6">Filter Properties</h2>
                <form id="filter-form">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2">Purpose</label>
                            <select id="purpose-filter"
                                class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary text-accent">
                                <option value="">All</option>
                                <option value="buy">Buy</option>
                                <option value="rent">Rent</option>
                                <option value="lease">Lease</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Property Type</label>
                            <select id="category-filter"
                                class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary text-accent">
                                <option value="">All Types</option>
                                <option value="residential">Residential</option>
                                <option value="commercial">Commercial</option>
                                <option value="land">Land</option>
                                <option value="farmhouse">Farmhouse</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Location</label>
                            <select id="location-filter"
                                class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary text-accent">
                                <option value="">All Locations</option>
                                <option value="sector-14">Delhi NCR</option>
                                <option value="sector-21">Gurgaon</option>
                                <option value="neelam-chowk">Mumbai</option>
                                <option value="greater-faridabad">Pune</option>
                                <option value="ballabgarh">Faridabad</option>
                                <option value="ballabgarh">Indore</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Budget (₹)</label>
                            <select id="budget-filter"
                                class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary text-accent">
                                <option value="">Any Budget</option>
                                <option value="0-50">Under 50 Lakhs</option>
                                <option value="50-100">50 Lakhs - 1 Cr</option>
                                <option value="100-150">1 Cr - 1.5 Cr</option>
                                <option value="150-200">1.5 Cr - 2 Cr</option>
                                <option value="200+">Above 2 Cr</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-between items-center">
                        <div>
                            <button type="reset" class="text-primary hover:text-secondary font-medium">
                                <i class="fas fa-redo mr-2"></i> Reset Filters
                            </button>
                        </div>
                        <div>
                            <button type="submit"
                                class="bg-primary hover:bg-secondary text-white font-medium py-2 px-6 rounded-md transition duration-300">
                                Apply Filters
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Property Listings -->
    <section class="py-12 bg-white">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <h2 class="text-2xl md:text-3xl font-bold text-primary">Available Properties (<span
                        id="property-count">0</span>)</h2>
                <div class="mt-4 md:mt-0">
                    <span class="text-gray-600 mr-3">Sort by:</span>
                    <select id="sort-select"
                        class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary text-accent">
                        <option value="newest">Newest First</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="area-small">Area: Small to Large</option>
                        <option value="area-large">Area: Large to Small</option>
                    </select>
                </div>
            </div>

            <div id="properties-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Loading State -->
                <div id="loading-state" class="col-span-full text-center py-12">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
                    <p class="mt-4 text-gray-600">Loading properties...</p>
                </div>

                <!-- No Properties State -->
                <div id="no-properties-state" class="col-span-full text-center py-12 hidden">
                    <i class="fas fa-home text-gray-400 text-4xl mb-4"></i>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">No Properties Found</h3>
                    <p class="text-gray-500">No properties match your current filter criteria.</p>
                </div>

                <!-- Properties will be loaded here dynamically -->
            </div>

            <!-- Pagination -->
            <div class="mt-12 flex justify-center">
                <nav class="flex items-center space-x-2">
                    <a href="#"
                        class="px-4 py-2 border border-gray-300 rounded-md text-primary hover:bg-primary hover:text-white transition duration-300">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    <a href="#" class="px-4 py-2 border border-gray-300 rounded-md bg-primary text-white">1</a>
                    <a href="#"
                        class="px-4 py-2 border border-gray-300 rounded-md text-primary hover:bg-primary hover:text-white transition duration-300">2</a>
                    <a href="#"
                        class="px-4 py-2 border border-gray-300 rounded-md text-primary hover:bg-primary hover:text-white transition duration-300">3</a>
                    <span class="px-4 py-2">...</span>
                    <a href="#"
                        class="px-4 py-2 border border-gray-300 rounded-md text-primary hover:bg-primary hover:text-white transition duration-300">8</a>
                    <a href="#"
                        class="px-4 py-2 border border-gray-300 rounded-md text-primary hover:bg-primary hover:text-white transition duration-300">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </nav>
            </div>
        </div>
    </section>

    <!-- Property Types Section -->
    <section class="py-12 bg-light">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-primary mb-4">Browse By Property Type</h2>
                <p class="text-lg text-accent max-w-2xl mx-auto">Find exactly what you're looking for by exploring our
                    property categories</p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <a href="#" class="bg-white rounded-lg overflow-hidden shadow-md group transition duration-300"
                    onclick="filterByCategory('residential')">
                    <div class="relative h-48">
                        <img src="https://images.unsplash.com/photo-1582268611958-ebfd161ef9cf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80"
                            alt="Residential" class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-primary bg-opacity-70 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                            <span class="text-white font-bold text-xl">Residential</span>
                        </div>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-lg font-bold text-primary">Residential Properties</h3>
                        <p class="text-gray-600 mt-1"><span id="residential-count">0</span> Properties</p>
                    </div>
                </a>

                <a href="#" class="bg-white rounded-lg overflow-hidden shadow-md group transition duration-300"
                    onclick="filterByCategory('commercial')">
                    <div class="relative h-48">
                        <img src="https://images.unsplash.com/photo-1497366811353-6870744d04b2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1469&q=80"
                            alt="Commercial" class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-primary bg-opacity-70 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                            <span class="text-white font-bold text-xl">Commercial</span>
                        </div>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-lg font-bold text-primary">Commercial Properties</h3>
                        <p class="text-gray-600 mt-1"><span id="commercial-count">0</span> Properties</p>
                    </div>
                </a>

                <a href="#" class="bg-white rounded-lg overflow-hidden shadow-md group transition duration-300"
                    onclick="filterByCategory('land')">
                    <div class="relative h-48">
                        <img src="https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1632&q=80"
                            alt="Land" class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-primary bg-opacity-70 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                            <span class="text-white font-bold text-xl">Land</span>
                        </div>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-lg font-bold text-primary">Land & Plots</h3>
                        <p class="text-gray-600 mt-1"><span id="land-count">0</span> Properties</p>
                    </div>
                </a>

                <a href="#" class="bg-white rounded-lg overflow-hidden shadow-md group transition duration-300"
                    onclick="filterByCategory('farmhouse')">
                    <div class="relative h-48">
                        <img src="https://images.unsplash.com/photo-1605276374104-dee2a0ed3cd6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80"
                            alt="Farmhouse" class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-primary bg-opacity-70 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                            <span class="text-white font-bold text-xl">Farmhouse</span>
                        </div>
                    </div>
                    <div class="p-4 text-center">
                        <h3 class="text-lg font-bold text-primary">Farmhouses</h3>
                        <p class="text-gray-600 mt-1"><span id="farmhouse-count">0</span> Properties</p>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-16 bg-primary text-white">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl md:text-4xl font-bold mb-6">Can't Find What You're Looking For?</h2>
            <p class="text-xl mb-8 max-w-2xl mx-auto">Let us know your requirements and we'll find the perfect property
                for you.</p>
            <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6">
                <a href="about.html"
                    class="bg-white hover:bg-secondary text-primary hover:text-white font-medium py-3 px-8 rounded-md transition duration-300">
                    Submit Your Requirement
                </a>
                <a id="cta" href="tel:+917091651137"
                    class="bg-transparent hover:bg-white border-2 border-white text-white hover:text-secondary font-medium py-3 px-8 rounded-md transition duration-300">
                    <i class="fas fa-phone mr-2"></i> Call Now
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-primary text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <img src="logo.jpeg" alt="Kartikeya Realty Logo" class="h-40 mb-4">
                    <p class="mb-4">Your trusted partner for all real estate needs in Faridabad and NCR region.</p>
                    <!-- <div class="flex space-x-4">
                        <a href="#" class="text-white hover:text-secondary text-xl"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-white hover:text-secondary text-xl"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-white hover:text-secondary text-xl"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-white hover:text-secondary text-xl"><i class="fab fa-linkedin-in"></i></a>
                    </div> -->
                </div>

                <div>
                    <h3 class="text-xl font-bold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="hover:text-secondary transition duration-300">Home</a></li>
                        <li><a href="properties.html"
                                class="hover:text-secondary transition duration-300">Properties</a></li>
                        <li><a href="investor-zone.html" class="hover:text-secondary transition duration-300">Investor
                                Zone</a></li>
                        <li><a href="first-time-buyers.html" class="hover:text-secondary transition duration-300">First
                                Time Buyers</a></li>
                        <li><a href="leasing-services.html" class="hover:text-secondary transition duration-300">Leasing
                                Services</a></li>
                        <li><a href="blog.html" class="hover:text-secondary transition duration-300">Blog</a></li>
                        <li><a href="about.html" class="hover:text-secondary transition duration-300">About Us</a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="text-xl font-bold mb-4">Contact Us</h3>
                    <ul id="contact-info" class="space-y-2">
                        <!-- Dynamic contact info will be loaded here -->
                        <li class="flex items-center">
                            <i class="fas fa-spinner fa-spin mr-2 text-secondary"></i>
                            <span>Loading contact information...</span>
                        </li>
                    </ul>
                </div>

                <div>
                    <h3 class="text-xl font-bold mb-4">Newsletter</h3>
                    <p class="mb-4">Subscribe to get updates on new properties and investment opportunities.</p>
                    <form class="flex">
                        <input type="email" placeholder="Your Email"
                            class="px-4 py-2 w-full rounded-l-md focus:outline-none text-accent">
                        <button type="submit"
                            class="bg-secondary hover:bg-white text-white hover:text-secondary px-4 py-2 rounded-r-md transition duration-300">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>

            <div class="border-t border-gray-700 mt-12 pt-6 text-center">
                <p>&copy; <span id="year"></span> Kartikeya Realty. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Global variables for filtering and sorting
        let allProperties = [];
        let filteredProperties = [];
        let currentFilters = {
            purpose: '',
            category: '',
            location: '',
            budget: ''
        };
        let currentSort = 'newest';
        let currentPage = 1;
        const propertiesPerPage = 9;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            loadProperties();
            loadContactInfo();
            setupEventListeners();
            setupMobileMenu();
            setCurrentYear();
        });

        // Load properties from API
        async function loadProperties() {
            try {
                showLoadingState();
                const response = await fetch('api/properties.php');
                const data = await response.json();

                if (data.success) {
                    allProperties = data.data;
                    filteredProperties = [...allProperties];
                    applySorting();
                    displayProperties();
                    updatePropertyCount();
                } else {
                    throw new Error(data.error || 'Failed to load properties');
                }
            } catch (error) {
                console.error('Error loading properties:', error);
                showNoPropertiesState('Error loading properties. Please try again later.');
            }
        }

        // Setup event listeners for filters and sorting
        function setupEventListeners() {
            // Filter elements by ID
            const purposeFilter = document.getElementById('purpose-filter');
            const categoryFilter = document.getElementById('category-filter');
            const locationFilter = document.getElementById('location-filter');
            const budgetFilter = document.getElementById('budget-filter');

            if (purposeFilter) {
                purposeFilter.addEventListener('change', function (e) {
                    currentFilters.purpose = e.target.value;
                    applyFilters();
                });
            }

            if (categoryFilter) {
                categoryFilter.addEventListener('change', function (e) {
                    currentFilters.category = e.target.value;
                    applyFilters();
                });
            }

            if (locationFilter) {
                locationFilter.addEventListener('change', function (e) {
                    currentFilters.location = e.target.value;
                    applyFilters();
                });
            }

            if (budgetFilter) {
                budgetFilter.addEventListener('change', function (e) {
                    currentFilters.budget = e.target.value;
                    applyFilters();
                });
            }

            // Sort dropdown
            const sortSelect = document.getElementById('sort-select');
            if (sortSelect) {
                sortSelect.addEventListener('change', handleSortChange);
            }

            // Reset filters button
            const filterForm = document.getElementById('filter-form');
            const resetButton = filterForm.querySelector('button[type="reset"]');
            if (resetButton) {
                resetButton.addEventListener('click', function (e) {
                    e.preventDefault();
                    resetFilters();
                });
            }

            // Apply filters button
            if (filterForm) {
                filterForm.addEventListener('submit', function (e) {
                    e.preventDefault();
                    applyFilters();
                });
            }
        }

        // Handle sort changes
        function handleSortChange(e) {
            currentSort = e.target.value;
            applySorting();
            displayProperties();
        }

        // Apply current filters
        function applyFilters() {
            filteredProperties = allProperties.filter(property => {
                // Purpose filter (map to status)
                if (currentFilters.purpose && currentFilters.purpose !== '') {
                    const statusMap = {
                        'buy': 'for_sale',
                        'rent': 'for_rent',
                        'lease': 'for_lease'
                    };
                    const requiredStatus = statusMap[currentFilters.purpose];
                    if (requiredStatus && property.status !== requiredStatus) {
                        return false;
                    }
                }

                // Category filter
                if (currentFilters.category && currentFilters.category !== '' &&
                    property.category !== currentFilters.category) {
                    return false;
                }

                // Location filter (simple text match)
                if (currentFilters.location && currentFilters.location !== '' &&
                    !property.location.toLowerCase().includes(currentFilters.location.replace('-', ' '))) {
                    return false;
                }

                // Budget filter
                if (currentFilters.budget && currentFilters.budget !== '') {
                    const budget = parseFloat(property.cost) / 100000; // Convert to lakhs
                    const [min, max] = currentFilters.budget.split('-').map(Number);

                    if (currentFilters.budget === '200+' && budget <= 200) return false;
                    if (min && max && (budget < min || budget > max)) return false;
                    if (min && !max && budget < min) return false;
                }

                return true;
            });

            applySorting();
            displayProperties();
            updatePropertyCount();
        }

        // Apply current sorting
        function applySorting() {
            filteredProperties.sort((a, b) => {
                switch (currentSort) {
                    case 'price-low':
                        return parseFloat(a.cost) - parseFloat(b.cost);
                    case 'price-high':
                        return parseFloat(b.cost) - parseFloat(a.cost);
                    case 'area-small':
                        return parseFloat(a.area || 0) - parseFloat(b.area || 0);
                    case 'area-large':
                        return parseFloat(b.area || 0) - parseFloat(a.area || 0);
                    case 'newest':
                    default:
                        return new Date(b.created_at) - new Date(a.created_at);
                }
            });
        }

        // Display properties
        function displayProperties() {
            const grid = document.getElementById('properties-grid');
            hideLoadingState();
            hideNoPropertiesState();

            if (filteredProperties.length === 0) {
                showNoPropertiesState();
                return;
            }

            // Clear existing properties
            const existingCards = grid.querySelectorAll('.property-card');
            existingCards.forEach(card => card.remove());

            // Display properties
            filteredProperties.forEach(property => {
                const propertyCard = createPropertyCard(property);
                grid.appendChild(propertyCard);
            });

            // Re-setup hover effects
            setupPropertyCardEffects();
        }

        // Create property card HTML
        function createPropertyCard(property) {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-lg overflow-hidden shadow-md property-card transition duration-300';

            const imageUrl = property.image_url || getDefaultImage(property.category);
            const statusLabel = getStatusLabel(property.status);
            const statusClass = getStatusClass(property.status);
            const formattedPrice = formatPrice(property.cost, property.status);

            card.innerHTML = `
                <div class="relative">
                    <img src="${imageUrl}" alt="${property.title}" class="w-full h-64 object-cover" onerror="this.src='${getDefaultImage(property.category)}'">
                    <div class="absolute top-4 right-4 ${statusClass} text-white px-3 py-1 rounded-full text-sm font-medium">${statusLabel}</div>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold text-primary mb-2">${property.title}</h3>
                    <p class="text-secondary text-lg font-semibold mb-2">${property.cost}</p>
                    <div class="flex items-center text-gray-600 mb-4">
                        <i class="fas fa-map-marker-alt mr-2"></i>
                        <span>${property.location}</span>
                    </div>
                    <div class="flex justify-between text-gray-600 mb-4">
                        ${getPropertyDetails(property)}
                    </div>
                    <div class="flex justify-between">
                        <a href="properties.html" class="text-primary hover:text-secondary font-medium">
                            View Details
                        </a>
                        <a href="tel:+917091651137" class="text-white bg-primary hover:bg-secondary px-4 py-1 rounded-md transition duration-300">
                            Enquire Now
                        </a>
                    </div>
                </div>
            `;

            return card;
        }

        // Get property details based on category
        function getPropertyDetails(property) {
            if (property.category === 'residential') {
                return `
                    <div class="flex items-center">
                        <i class="fas fa-bed mr-2"></i>
                        <span>${property.bedrooms || 'N/A'} Beds</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-bath mr-2"></i>
                        <span>${property.bathrooms || 'N/A'} Baths</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-vector-square mr-2"></i>
                        <span>${property.area || 'N/A'} sq.ft</span>
                    </div>
                `;
            } else if (property.category === 'commercial') {
                return `
                    <div class="flex items-center">
                        <i class="fas fa-building mr-2"></i>
                        <span>Commercial</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-vector-square mr-2"></i>
                        <span>${property.area || 'N/A'} sq.ft</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-briefcase mr-2"></i>
                        <span>Business</span>
                    </div>
                `;
            } else if (property.category === 'land') {
                return `
                    <div class="flex items-center">
                        <i class="fas fa-ruler-combined mr-2"></i>
                        <span>${property.area || 'N/A'} sq.ft</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-road mr-2"></i>
                        <span>Road Access</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-compass mr-2"></i>
                        <span>Plot</span>
                    </div>
                `;
            } else if (property.category === 'farmhouse') {
                return `
                    <div class="flex items-center">
                        <i class="fas fa-home mr-2"></i>
                        <span>${property.bedrooms || 'N/A'} Beds</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-tree mr-2"></i>
                        <span>Farmhouse</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-vector-square mr-2"></i>
                        <span>${property.area || 'N/A'} sq.ft</span>
                    </div>
                `;
            }
            return `
                <div class="flex items-center">
                    <i class="fas fa-home mr-2"></i>
                    <span>Property</span>
                </div>
                <div class="flex items-center">
                    <i class="fas fa-vector-square mr-2"></i>
                    <span>${property.area || 'N/A'} sq.ft</span>
                </div>
                <div class="flex items-center">
                    <i class="fas fa-info-circle mr-2"></i>
                    <span>Details</span>
                </div>
            `;
        }

        // Utility functions
        function getStatusLabel(status) {
            const labels = {
                'for_sale': 'For Sale',
                'for_rent': 'For Rent',
                'for_lease': 'For Lease',
                'sold': 'Sold',
                'rented': 'Rented'
            };
            return labels[status] || 'Available';
        }

        function getStatusClass(status) {
            const classes = {
                'for_sale': 'bg-secondary',
                'for_rent': 'bg-primary',
                'for_lease': 'bg-primary',
                'sold': 'bg-gray-500',
                'rented': 'bg-gray-500'
            };
            return classes[status] || 'bg-secondary';
        }

        function formatPrice(cost, status) {
            const amount = parseFloat(cost);
            if (status === 'for_rent' || status === 'for_lease') {
                if (amount >= 100000) {
                    return `₹${(amount / 100000).toFixed(1)} Lakhs/month`;
                } else {
                    return `₹${amount.toLocaleString()}/month`;
                }
            } else {
                if (amount >= 10000000) {
                    return `₹${(amount / 10000000).toFixed(2)} Cr`;
                } else {
                    return `₹${(amount / 100000).toFixed(1)} Lakhs`;
                }
            }
        }

        function getDefaultImage(category) {
            const defaultImages = {
                'residential': 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80',
                'commercial': 'https://images.unsplash.com/photo-1497366811353-6870744d04b2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1469&q=80',
                'land': 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=1632&q=80',
                'farmhouse': 'https://images.unsplash.com/photo-1605276374104-dee2a0ed3cd6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80'
            };
            return defaultImages[category] || defaultImages['residential'];
        }

        function showLoadingState() {
            document.getElementById('loading-state').style.display = 'block';
            document.getElementById('no-properties-state').style.display = 'none';
        }

        function hideLoadingState() {
            document.getElementById('loading-state').style.display = 'none';
        }

        function showNoPropertiesState(message = null) {
            const noPropsEl = document.getElementById('no-properties-state');
            if (message) {
                noPropsEl.querySelector('p').textContent = message;
            }
            noPropsEl.style.display = 'block';
        }

        function hideNoPropertiesState() {
            document.getElementById('no-properties-state').style.display = 'none';
        }

        function updatePropertyCount() {
            const countEl = document.getElementById('property-count');
            if (countEl) {
                countEl.textContent = filteredProperties.length;
            }

            // Update property type counts
            updatePropertyTypeCounts();
        }

        function updatePropertyTypeCounts() {
            const categoryCounts = {
                residential: 0,
                commercial: 0,
                land: 0,
                farmhouse: 0
            };

            allProperties.forEach(property => {
                if (categoryCounts.hasOwnProperty(property.category)) {
                    categoryCounts[property.category]++;
                }
            });

            // Update DOM elements
            const residentialCount = document.getElementById('residential-count');
            const commercialCount = document.getElementById('commercial-count');
            const landCount = document.getElementById('land-count');
            const farmhouseCount = document.getElementById('farmhouse-count');

            if (residentialCount) residentialCount.textContent = categoryCounts.residential;
            if (commercialCount) commercialCount.textContent = categoryCounts.commercial;
            if (landCount) landCount.textContent = categoryCounts.land;
            if (farmhouseCount) farmhouseCount.textContent = categoryCounts.farmhouse;
        }

        function filterByCategory(category) {
            // Reset all filters
            resetFilters();

            // Set category filter
            currentFilters.category = category;

            // Update UI
            const categoryFilter = document.getElementById('category-filter');
            if (categoryFilter) {
                categoryFilter.value = category;
            }

            // Apply filter and scroll to properties
            applyFilters();

            // Scroll to properties section
            const propertiesSection = document.querySelector('#properties-grid').closest('section');
            if (propertiesSection) {
                propertiesSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            return false; // Prevent link navigation
        }

        function resetFilters() {
            currentFilters = {
                purpose: '',
                category: '',
                location: '',
                budget: ''
            };

            // Reset form
            const form = document.getElementById('filter-form');
            if (form) {
                form.reset();
            }

            // Re-apply (will show all)
            applyFilters();
        }

        function enquireNow(propertyTitle) {
            // You can customize this function to open a contact form or redirect
            const message = `I'm interested in: ${propertyTitle}`;
            const phoneNumber = '917091651137';
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function setupPropertyCardEffects() {
            const propertyCards = document.querySelectorAll('.property-card');
            propertyCards.forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-5px)';
                    this.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.1)';
                });
                card.addEventListener('mouseleave', function () {
                    this.style.transform = '';
                    this.style.boxShadow = '';
                });
            });
        }

        function setupMobileMenu() {
            const menuButton = document.getElementById('mobile-menu-button');
            const menu = document.getElementById('mobile-menu');

            if (menuButton && menu) {
                menuButton.addEventListener('click', function () {
                    menu.classList.toggle('hidden');
                });
            }
        }

        function setCurrentYear() {
            const yearEl = document.getElementById('year');
            if (yearEl) {
                yearEl.textContent = new Date().getFullYear();
            }
        }

        // Load contact information
        async function loadContactInfo() {
            try {
                const response = await fetch('api/contact-info.php?active=1');
                const data = await response.json();

                if (data.success) {
                    updateContactInfo(data.data);
                    updateHeaderPhone(data.data.phone);
                }
            } catch (error) {
                console.error('Error loading contact info:', error);
            }
        }

        // Update contact information in DOM
        function updateContactInfo(contactData) {
            // Update header phone number
            const headerPhone = document.querySelector('header a[href^="tel:"]');
            if (headerPhone && contactData.phone && contactData.phone.length > 0) {
                const primaryPhone = contactData.phone[0];
                headerPhone.href = `tel:+91${primaryPhone.value}`;
                headerPhone.innerHTML = `<i class="fas fa-phone mr-1"></i> ${primaryPhone.value}`;
            }

            // Update mobile menu phone number
            const mobilePhone = document.querySelector('#mobile-menu a[href^="tel:"]');
            if (mobilePhone && contactData.phone && contactData.phone.length > 0) {
                const primaryPhone = contactData.phone[0];
                mobilePhone.href = `tel:+91${primaryPhone.value}`;
                mobilePhone.innerHTML = `<i class="fas fa-phone mr-1"></i> ${primaryPhone.value}`;
            }

            // Update footer contact section
            updateFooterContact(contactData);

            // Update footer social media
            updateFooterSocials(contactData);
        }

        function updateFooterContact(contactData) {
            const contactSection = document.querySelector('footer .grid div:nth-child(3) ul');
            if (!contactSection) return;

            let contactHTML = '';

            // Add addresses
            if (contactData.address) {
                contactData.address.forEach(addr => {
                    contactHTML += `
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt mr-2 text-secondary mt-1"></i>
                            <span>${addr.value}</span>
                        </li>
                    `;
                });
            }

            // Add phone numbers
            if (contactData.phone) {
                contactData.phone.forEach(phone => {
                    contactHTML += `
                        <li class="flex items-center">
                            <i class="fas fa-phone-alt mr-2 text-secondary"></i>
                            <span>${phone.value}</span>
                        </li>
                    `;
                });
            }

            // Add emails
            if (contactData.email) {
                contactData.email.forEach(email => {
                    contactHTML += `
                        <li class="flex items-center">
                            <i class="fas fa-envelope mr-2 text-secondary"></i>
                            <span>${email.value}</span>
                        </li>
                    `;
                });
            }

            if (contactHTML) {
                contactSection.innerHTML = contactHTML;
            }
        }

        function updateFooterSocials(contactData) {
            const socialSection = document.querySelector('footer .flex.space-x-4');
            if (!socialSection || !contactData.social_media) return;

            const socialIcons = {
                'facebook': 'fab fa-facebook-f',
                'twitter': 'fab fa-twitter',
                'instagram': 'fab fa-instagram',
                'linkedin': 'fab fa-linkedin-in',
                'youtube': 'fab fa-youtube',
                'whatsapp': 'fab fa-whatsapp'
            };

            let socialHTML = '';
            contactData.social_media.forEach(social => {
                const platform = social.label.toLowerCase();
                const iconClass = socialIcons[platform] || 'fas fa-link';

                socialHTML += `
                    <a href="${social.value}" target="_blank" class="text-white hover:text-secondary text-xl">
                        <i class="${iconClass}"></i>
                    </a>
                `;
            });

            if (socialHTML) {
                socialSection.innerHTML = socialHTML;
            }
        }

        // Update header phone number
        function updateHeaderPhone(phones) {
            if (phones && phones.length > 0) {
                const primaryPhone = phones[0];
                const headerPhone = document.getElementById('header-phone');
                const headerPhoneMob = document.getElementById('header-phone-mob');
                const cta = document.getElementById('cta');
                if (headerPhone) {
                    headerPhone.href = `tel:${primaryPhone.value}`;
                    headerPhoneMob.href = `tel:${primaryPhone.value}`;
                    cta.href = `tel:${primaryPhone.value}`;
                }
            }
        }
    </script>
</body>

</html>